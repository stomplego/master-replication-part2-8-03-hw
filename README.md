# Домашнее задание к занятию «Репликация и масштабирование. Часть 2» Соколов Тимофей

### Инструкция по выполнению домашнего задания

1. Сделайте fork [репозитория c шаблоном решения](https://github.com/netology-code/sys-pattern-homework) к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/gitlab-hw или https://github.com/имя-вашего-репозитория/8-03-hw).
2. Выполните клонирование этого репозитория к себе на ПК с помощью команды `git clone`.
3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
   - впишите вверху название занятия и ваши фамилию и имя;
   - в каждом задании добавьте решение в требуемом виде: текст/код/скриншоты/ссылка;
   - для корректного добавления скриншотов воспользуйтесь инструкцией [«Как вставить скриншот в шаблон с решением»](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md);
   - при оформлении используйте возможности языка разметки md. Коротко об этом можно посмотреть в [инструкции по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md).
4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`).
5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
6. Любые вопросы задавайте в чате учебной группы и/или в разделе «Вопросы по заданию» в личном кабинете.

Желаем успехов в выполнении домашнего задания.

---

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;


*Дайте ответ в свободной форме.*

1. Активный Master и пассивный Slave:
Отказоустойчивость: Если мастер "упал", его можно быстро заменить слейвом, чтобы сайт почти не простаивал.
Безопасный бэкап: Можно делать резервные копии со слейва, не нагружая и не блокируя основной сервер.
Тестирование: На слейве можно запускать тяжёлые запросы аналитики, не мешая работе основного сервиса.

2. Master и несколько Slave-серверов:
Масштабирование чтения: Основная польза. Все запросы на чтение (SELECT) можно раздать на несколько слейвов. Это сильно увеличивает скорость отдачи данных пользователям.
Надёжность: Если один слейв сломается, остальные продолжат работать.
Разделение нагрузки: Разные слейвы можно использовать для разных целей: один для сайта, другой для отчётов, третий для поиска.

Главное отличие: активный Master — это про надёжность и подстраховку. Master и несколько Slave-серверов — про производительность и скорость обработки запросов на чтение.

---

### Задание 2


Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

1. Вертикальный шардинг:
- Сервер 1 (Users DB): Хранит только таблицу users;
- Сервер 2 (Books DB): Хранит только таблицу books;
- Сервер 3 (Shops DB): Хранит только таблицу shops.

2. Горизонтальный шардинг:
- Для users: Шардирование по user_id (например, по диапазону ID или по четности/нечетности). Это равномерно распределит нагрузку;
- Для books: Шардирование по genre или author_id. Запросы чаще всего идут по жанру или автору, что позволит обрабатывать их на одном шарде;
- Для shops: Шардирование по region или country. Позволит хранить данные магазинов одного региона вместе для быстрого доступа.

flowchart TD
    subgraph Application Layer [Слой приложения]
        A[Приложение\n/ Балансировщик запросов]
    end

    subgraph VerticalSharding [Вертикальный шардинг<br>Разделение по таблицам]
        direction LR

        subgraph Server1 [Сервер 1: Users DB]
            U1[Shard 1<br>user_id 1-50M]
            U2[Shard 2<br>user_id 50M-100M]
        end

        subgraph Server2 [Сервер 2: Books DB]
            B1[Shard 1<br>Жанр: Фантастика]
            B2[Shard 2<br>Жанр: Детективы]
            B3[Shard N<br>Другие жанры]
        end

        subgraph Server3 [Serвер 3: Shops DB]
            S1[Shard 1<br>Регион: Европа]
            S2[Shard 2<br>Регион: Азия]
            S3[Shard N<br>Другие регионы]
        end
    end

    A -- Запросы к пользователям --> Server1
    A -- Запросы к книгам --> Server2
    A -- Запросы к магазинам --> Server3

Режимы работы серверов
Сервер 1 (Users DB): Master-Slave репликация. Один мастер для операций записи (регистрация, изменение профиля) и несколько слейвов для операций чтения (логин, просмотр профиля). Горизонтальный шардинг будет осуществлен на уровне мастеров.
Сервер 2 (Books DB): Active-Active кластер. Так как данные о книгах могут обновляться нечасто, но читаются часто, подойдет кластер, где несколько нод могут принимать запросы на чтение.
Сервер 3 (Shops DB): Master-Master репликация. Для магазинов важна возможность записи в разных регионах с последующей синхронизацией (например, обновление ассортимента).
